import{_ as I,r as h,k as C,x as c,y as l,z as s,E as u,N as Q,O as q,B as n,g as N,Q as O,P as U,F as k,G as w,A as o,S as x,D as g,R as j,T as G}from"./BQPUzQds.js";const H={class:"qr-list"},J={class:"search-section"},K={class:"search-input-group"},W=["value"],X={key:0,class:"loading-section"},Y={key:1,class:"qr-list-container"},Z={key:0,class:"empty-state"},ss=["onClick"],ts={class:"qr-card-content"},es={class:"qr-card-header"},as={class:"qr-badges"},is={class:"qr-badge"},os={class:"qr-date"},ns={class:"qr-card-body"},ls={class:"qr-info"},ds={class:"qr-title"},cs={class:"qr-details"},rs={class:"qr-detail-item"},us={class:"qr-detail-row"},vs={class:"qr-detail-item price"},ps={class:"qr-detail-item"},gs={class:"qr-preview"},fs=["src","alt"],hs={class:"qr-overlay"},_s={key:2,class:"pagination-section"},ms={class:"pagination-info"},bs={class:"pagination-text"},ys={class:"pagination-count"},Cs={class:"pagination-controls"},ks=["disabled"],ws={class:"pagination-numbers"},Ps=["disabled","onClick"],$s=["disabled"],Qs={key:3,class:"refresh-section"},qs={class:"modal-header"},xs={class:"modal-title"},Ts={key:0,class:"modal-body"},Ds={class:"qr-showcase"},Fs=["src","alt"],Ls={class:"details-grid"},Rs={class:"detail-card"},As={class:"detail-card-icon detail-card-icon--blue"},Es={class:"detail-card-content"},Vs={class:"detail-value"},Bs={class:"detail-card"},Ms={class:"detail-card-icon detail-card-icon--purple"},Ss={class:"detail-card-content"},zs={class:"detail-value"},Is={class:"detail-card"},Ns={class:"detail-card-icon detail-card-icon--green"},Os={class:"detail-card-content"},Us={class:"detail-value detail-value--price"},js={class:"detail-card"},Gs={class:"detail-card-icon detail-card-icon--orange"},Hs={class:"detail-card-content"},Js={class:"detail-value"},Ks={class:"detail-card"},Ws={class:"detail-card-icon detail-card-icon--cyan"},Xs={class:"detail-card-content"},Ys={class:"detail-value"},Zs={class:"detail-card"},st={class:"detail-card-icon detail-card-icon--indigo"},tt={class:"detail-card-content"},et={class:"detail-value"},at={class:"modal-actions"},it=["disabled"],ot={key:1,class:"loading-spinner"},nt={__name:"QrList",props:{qrCodes:{type:Array,default:()=>[]},pagination:{type:Object,default:null},isLoading:{type:Boolean,default:!1}},emits:["refresh-list","edit-qr-code","change-page"],setup(r,{emit:T}){const _=r,b=T,f=h(""),m=h(""),v=h(!1),d=h(null),p=h(!1),D=C(()=>[...new Set(_.qrCodes.map(t=>t.typeProduit))].map(t=>({label:t,value:t}))),P=C(()=>{let a=_.qrCodes;return f.value&&(a=a.filter(t=>t.nomProduit.toLowerCase().includes(f.value.toLowerCase())||t.franchise.toLowerCase().includes(f.value.toLowerCase()))),m.value&&(a=a.filter(t=>t.typeProduit===m.value)),a.sort((t,i)=>new Date(i.dateCreation)-new Date(t.dateCreation))}),F=()=>{v.value=!1},L=a=>{d.value=a,v.value=!0},R=a=>{const t=document.createElement("a");t.href=a.codePng,t.download=`qr-${a.nomProduit}-${a.poids}${a.unitePoids}-${a.prixVente}FCFA.png`,t.click()},A=a=>{v.value=!1,b("edit-qr-code",a)},E=async a=>{if(confirm(`Êtes-vous sûr de vouloir supprimer le QR code "${a.nomProduit}" ?`))try{p.value=!0,(await $fetch(`/api/qrcodes?id=${a.id}`,{method:"DELETE"})).success&&(v.value=!1,b("refresh-list"),$("QR Code supprimé avec succès !","success"))}catch(t){console.error("Erreur lors de la suppression:",t),$("Erreur lors de la suppression du QR code","error")}finally{p.value=!1}},$=(a,t="info")=>{const i=document.createElement("div");i.className=`notification notification--${t}`,i.textContent=a,document.body.appendChild(i),setTimeout(()=>{i.remove()},3e3)},V=a=>new Date(a).toLocaleDateString("fr-FR",{day:"2-digit",month:"2-digit",year:"numeric",hour:"2-digit",minute:"2-digit"}),B=a=>{switch(a){case"raw":return"Brut";case"result":return"Résultat";default:return"Brut"}},M=a=>{switch(a){case"raw":return"qr-badge--raw";case"result":return"qr-badge--result";default:return"qr-badge--raw"}},y=a=>{b("change-page",a)},S=C(()=>{if(!_.pagination)return[];const{page:a,totalPages:t}=_.pagination,i=[];a>1&&(i.push(1),a>3&&i.push("..."));for(let e=Math.max(2,a-1);e<=Math.min(t-1,a+1);e++)e>1&&e<t&&i.push(e);return a<t&&(a<t-2&&i.push("..."),i.push(t)),i});return(a,t)=>{const i=N("FontAwesomeIcon");return l(),c("div",H,[s("div",J,[s("div",K,[n(i,{icon:"fa-search",class:"search-icon"}),q(s("input",{"onUpdate:modelValue":t[0]||(t[0]=e=>f.value=e),type:"text",class:"search-input",placeholder:"Rechercher un produit..."},null,512),[[O,f.value]])]),q(s("select",{"onUpdate:modelValue":t[1]||(t[1]=e=>m.value=e),class:"filter-select"},[t[10]||(t[10]=s("option",{value:""},"Tous les types",-1)),(l(!0),c(k,null,w(D.value,e=>(l(),c("option",{key:e.value,value:e.value},o(e.label),9,W))),128))],512),[[U,m.value]])]),r.isLoading?(l(),c("div",X,t[11]||(t[11]=[s("div",{class:"loading-spinner-large"},null,-1),s("p",{class:"loading-text"},"Chargement des QR codes...",-1)]))):(l(),c("div",Y,[P.value.length===0?(l(),c("div",Z,[n(i,{icon:"fa-qrcode",class:"empty-icon"}),t[12]||(t[12]=s("p",{class:"empty-text"},"Aucun QR code trouvé",-1)),t[13]||(t[13]=s("p",{class:"empty-subtext"},"Créez votre premier code QR !",-1))])):u("",!0),(l(!0),c(k,null,w(P.value,e=>(l(),c("div",{key:e.id,class:"qr-card",onClick:z=>L(e)},[s("div",ts,[s("div",es,[s("div",as,[s("span",is,o(e.typeProduit),1),s("span",{class:x(["qr-badge qr-badge--type",M(e.qrType)])},o(B(e.qrType)),3)]),s("span",os,o(V(e.dateCreation)),1)]),s("div",ns,[s("div",ls,[s("h3",ds,o(e.nomProduit),1),s("div",cs,[s("div",rs,[n(i,{icon:"fa-building",class:"detail-icon"}),s("span",null,o(e.franchise),1)]),s("div",us,[s("div",vs,[n(i,{icon:"fa-dollar-sign",class:"detail-icon"}),s("span",null,o(e.prixVente)+" FCFA",1)]),s("div",ps,[n(i,{icon:"fa-weight-hanging",class:"detail-icon"}),s("span",null,o(e.poids)+" "+o(e.unitePoids),1)])])])]),s("div",gs,[s("img",{src:e.codePng,alt:`QR Code ${e.nomProduit}`,class:"qr-mini"},null,8,fs),s("div",hs,[n(i,{icon:"fa-eye"})])])])])],8,ss))),128))])),r.pagination&&r.pagination.totalPages>1&&!r.isLoading?(l(),c("div",_s,[s("div",ms,[s("span",bs," Page "+o(r.pagination.page)+" sur "+o(r.pagination.totalPages),1),s("span",ys,o(r.pagination.total)+" QR codes au total ",1)]),s("div",Cs,[s("button",{class:"btn btn--outline btn--small",disabled:!r.pagination.hasPrev,onClick:t[2]||(t[2]=e=>y(r.pagination.page-1))},[n(i,{icon:"fa-chevron-left",class:"btn-icon"}),t[14]||(t[14]=g(" Précédent ",-1))],8,ks),s("div",ws,[(l(!0),c(k,null,w(S.value,e=>(l(),c("button",{key:e,class:x(["btn btn--small",e===r.pagination.page?"btn--primary":"btn--outline"]),disabled:e==="...",onClick:z=>e!=="..."&&y(e)},o(e),11,Ps))),128))]),s("button",{class:"btn btn--outline btn--small",disabled:!r.pagination.hasNext,onClick:t[3]||(t[3]=e=>y(r.pagination.page+1))},[t[15]||(t[15]=g(" Suivant ",-1)),n(i,{icon:"fa-chevron-right",class:"btn-icon"})],8,$s)])])):u("",!0),r.isLoading?u("",!0):(l(),c("div",Qs,[s("button",{class:"btn btn--outline btn--block",onClick:t[4]||(t[4]=e=>a.$emit("refresh-list"))},[n(i,{icon:"fa-refresh",class:"btn-icon"}),t[16]||(t[16]=g(" Actualiser la liste ",-1))])])),(l(),Q(G,{to:"body"},[v.value?(l(),c("div",{key:0,class:"modal-overlay",onClick:F},[s("div",{class:"modal modal--large",onClick:t[9]||(t[9]=j(()=>{},["stop"]))},[s("div",qs,[s("h3",xs,o(d.value?.nomProduit),1),s("button",{class:"btn btn--ghost btn--small",onClick:t[5]||(t[5]=e=>v.value=!1)},[n(i,{icon:"fa-times"})])]),d.value?(l(),c("div",Ts,[s("div",Ds,[s("img",{src:d.value.codePng,alt:`QR Code ${d.value.nomProduit}`,class:"qr-large"},null,8,Fs)]),s("div",Ls,[s("div",Rs,[s("div",As,[n(i,{icon:"fa-tag"})]),s("div",Es,[t[17]||(t[17]=s("span",{class:"detail-label"},"Type",-1)),s("span",Vs,o(d.value.typeProduit),1)])]),s("div",Bs,[s("div",Ms,[n(i,{icon:"fa-building"})]),s("div",Ss,[t[18]||(t[18]=s("span",{class:"detail-label"},"Franchise",-1)),s("span",zs,o(d.value.franchise),1)])]),s("div",Is,[s("div",Ns,[n(i,{icon:"fa-dollar-sign"})]),s("div",Os,[t[19]||(t[19]=s("span",{class:"detail-label"},"Prix",-1)),s("span",Us,o(d.value.prixVente)+" FCFA",1)])]),s("div",js,[s("div",Gs,[n(i,{icon:"fa-weight-hanging"})]),s("div",Hs,[t[20]||(t[20]=s("span",{class:"detail-label"},"Poids",-1)),s("span",Js,o(d.value.poids)+" "+o(d.value.unitePoids),1)])]),s("div",Ks,[s("div",Ws,[n(i,{icon:"fa-cog"})]),s("div",Xs,[t[21]||(t[21]=s("span",{class:"detail-label"},"Fournisseur",-1)),s("span",Ys,o(d.value.fournisseur),1)])]),s("div",Zs,[s("div",st,[n(i,{icon:"fa-user"})]),s("div",tt,[t[22]||(t[22]=s("span",{class:"detail-label"},"Créé par",-1)),s("span",et,o(d.value.user?.nom||"Utilisateur"),1)])])]),s("div",at,[s("button",{class:"btn btn--outline",onClick:t[6]||(t[6]=e=>R(d.value))},[n(i,{icon:"fa-download",class:"btn-icon"}),t[23]||(t[23]=g(" Télécharger HD ",-1))]),s("button",{class:"btn btn--primary",onClick:t[7]||(t[7]=e=>A(d.value))},[n(i,{icon:"fa-edit",class:"btn-icon"}),t[24]||(t[24]=g(" Modifier ",-1))]),s("button",{class:"btn btn--danger",onClick:t[8]||(t[8]=e=>E(d.value)),disabled:p.value},[p.value?u("",!0):(l(),Q(i,{key:0,icon:"fa-trash",class:"btn-icon"})),p.value?(l(),c("div",ot)):u("",!0),g(" "+o(p.value?"Suppression...":"Supprimer"),1)],8,it)])])):u("",!0)])])):u("",!0)]))])}}},dt=I(nt,[["__scopeId","data-v-a5938357"]]);export{dt as default};
